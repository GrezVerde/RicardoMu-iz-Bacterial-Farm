<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galer√≠a de Muestras</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="Hoja de estilo corrector.css">
    
    <style>
        /* --- ESTILOS GENERALES --- */
        body.pagina-interna {
            margin: 0; padding: 0;
            font-family: 'Montserrat', sans-serif;
            background-color: #1a1a1a; 
            background-size: cover; background-position: center; background-attachment: fixed;
            min-height: 100vh;
        }

        .contenido-interno {
            display: flex; flex-direction: column; align-items: center; padding: 40px 20px;
        }

        /* --- ENCABEZADO --- */
        .header-container {
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px);
            padding: 30px 50px; border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 40px; text-align: center;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
            max-width: 800px;
        }

        .titulo-galeria {
            font-size: 3rem; font-weight: 900; color: #4ade80; margin: 0;
            text-transform: uppercase; letter-spacing: 2px;
            text-shadow: 3px 3px 0px rgba(0,0,0,0.5); 
        }

        .subtitulo-galeria {
            font-size: 1.2rem; color: #e0e0e0; margin-top: 10px; margin-bottom: 0; font-weight: 400;
        }

        /* --- GRID GALER√çA --- */
        .galeria-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 25px; width: 100%; max-width: 1000px; margin-bottom: 40px;
        }

        .item-galeria {
            position: relative; cursor: pointer; border-radius: 15px; overflow: hidden;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            aspect-ratio: 1 / 1; border: 3px solid rgba(255,255,255,0.1);
            background: #000; box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        .item-galeria:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 10px 30px rgba(74, 222, 128, 0.3); border-color: #4ade80;
        }

        .thumb-img {
            width: 100%; height: 100%; object-fit: cover; transition: transform 0.5s;
        }
        .item-galeria:hover .thumb-img { transform: scale(1.1); }

        /* Estilo para items bloqueados */
        .item-bloqueado { pointer-events: none; }
        .item-bloqueado .thumb-img { filter: grayscale(100%) blur(2px); opacity: 0.5; }

        /* Capa de Candado (Bloqueado) */
        .capa-info-bloqueo {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.6); display: flex; flex-direction: column;
            justify-content: center; align-items: center; text-align: center; padding: 10px;
        }
        .icono-candado { font-size: 3rem; opacity: 0.9; margin-bottom: 10px; text-shadow: 0 0 10px black;}
        .texto-pista { color: #fff; font-size: 0.85rem; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; }

        /* Etiqueta de Logro (Desbloqueado) */
        .badge-logro {
            position: absolute; bottom: 0; left: 0; width: 100%;
            background: rgba(74, 222, 128, 0.9); color: #000;
            padding: 8px; text-align: center; font-weight: 800;
            font-size: 0.8rem; text-transform: uppercase;
            transform: translateY(100%); transition: transform 0.3s;
        }
        .item-galeria:hover .badge-logro { transform: translateY(0); }

        .btn-regresar {
            background: rgba(0,0,0,0.8); border: 2px solid #4ade80; color: #4ade80;
            padding: 12px 30px; cursor: pointer; font-size: 1rem; font-weight: bold;
            border-radius: 50px; transition: all 0.3s; text-transform: uppercase;
            letter-spacing: 1px; backdrop-filter: blur(5px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        .btn-regresar:hover {
            background: #4ade80; color: #000; box-shadow: 0 0 20px #4ade80; transform: scale(1.05);
        }

        /* --- MODAL --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.9); display: flex; justify-content: center; align-items: center;
            opacity: 0; pointer-events: none; transition: opacity 0.3s ease; z-index: 1000;
        }

        .modal-activa { opacity: 1; pointer-events: auto; }

        .modal-contenedor-interno {
            background: #1a1a1a; width: 90%; max-width: 500px;
            border-radius: 20px; overflow: hidden;
            box-shadow: 0 20px 50px rgba(0,0,0,0.9);
            border: 1px solid #333; display: flex; flex-direction: column;
            animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            padding-bottom: 30px; 
        }

        @keyframes popIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }

        .modal-imagen {
            width: 100%; height: 250px; object-fit: cover;
            border-bottom: 4px solid #4ade80;
        }

        .modal-texto { padding: 30px 30px 10px 30px; text-align: left; }

        .modal-titulo {
            font-size: 1.8rem; color: #4ade80; margin: 0 0 10px 0;
            font-weight: 800; text-transform: uppercase;
        }

        .modal-desc-texto {
            font-size: 1rem; line-height: 1.6; color: #ddd; margin: 0;
            text-align: justify; font-weight: 400;
        }

        .modal-footer-logro {
            padding: 0 30px 20px 30px;
            color: #777; font-size: 0.8rem; font-style: italic;
            border-bottom: 1px solid #333; margin-bottom: 20px;
        }

        .btn-cerrar-modal {
            background: #333; color: #fff; border: 1px solid #555; 
            padding: 12px 40px; cursor: pointer; font-weight: bold; font-size: 0.9rem;
            transition: all 0.3s; text-transform: uppercase; letter-spacing: 2px;
            border-radius: 50px; margin: 0 auto; width: fit-content; display: block;
        }
        
        .btn-cerrar-modal:hover { 
            background: #e74c3c; border-color: #e74c3c;
            transform: scale(1.05); box-shadow: 0 5px 15px rgba(231, 76, 60, 0.4);
        }

    </style>
</head>
<body class="pagina-interna">

    <section class="contenido-interno">
        
        <div class="header-container">
            <h1 class="titulo-galeria">Galer√≠a de Muestras</h1>
            <p class="subtitulo-galeria">Desbloquea logros cultivando en el laboratorio.</p>
        </div>
        
        <div class="galeria-grid" id="grid-galeria">
            </div>
        
        <button class="btn-regresar" onclick="window.location.href='index.html'">
            ‚¨Ö Volver al Men√∫
        </button>
    </section>

    <div id="miModal" class="modal-overlay" onclick="cerrarModal()">
        <div class="modal-contenedor-interno" onclick="event.stopPropagation()">
            <img id="img-grande" class="modal-imagen" src="" alt="">
            
            <div class="modal-texto">
                <h2 id="titulo-grande" class="modal-titulo">T√çTULO</h2>
                <p id="desc-grande" class="modal-desc-texto">Descripci√≥n...</p>
            </div>
            
            <div class="modal-footer-logro" id="logro-footer">
                üèÜ Logro obtenido: ...
            </div>
            
            <button class="btn-cerrar-modal" onclick="cerrarModal()">CERRAR</button>
        </div>
    </div>

    <script>
        // --- 1. DATOS MIXTOS (Biolog√≠a + Logros) ---
        const COLECCION = [
            { 
                id: 1, 
                titulo: "Helicobacter Pylori", // Info Biol√≥gica
                desc: "Tipo espiroqueta, Es una bacteria con forma de espiral (como un sacacorchos) que tiene la incre√≠ble habilidad de vivir en el √°cido de tu est√≥mago. Se estima que la mitad de la poblaci√≥n mundial la tiene en su interior. Antes se cre√≠a que las √∫lceras eran causadas por el estr√©s o la comida picante pero en los a√±os 80 Barry Marshall y Robin Warren descubrieron que esta bacteria era la verdadera culpable de la gastritis y las √∫lceras. Bebieron un vaso lleno de bacterias para demostrarlo y les vali√≥ el Premio Nobel", 
                img: "Assets/Bactcard6.jpg", // Aseg√∫rate que esta imagen existe
                logro: "Cient√≠fico Novato", // Info del Juego
                pista: "Desbloqueado por defecto",
                condicion: "GRATIS" 
            },
            { 
                id: 2, 
                titulo: "Verrucomicrobium Spinosum", 
                desc: "Tipo bacilo, es una bacteria que vive en el agua dulce (lagos y estanques). Su nombre literalmente significa microbio con verrugas espinosas. Tiene el cuerpo cubierto de bultos c√≥nicos, A diferencia de los pili o flagelos (que son como pelos pegados encima), estas protuberancias son extensiones de su propio cuerpo (llamadas prostecas). Estos bultos le permiten tener m√°s superficie de contacto con el agua y poder ingresar m√°s alimento.", 
                img: "Assets/Bactcard8.jpg", 
                logro: "Cultivo Iniciado", 
                pista: "Cultiva al menos 1 muestra con √©xito.",
                condicion: "PRIMER_CULTIVO"
            },
            { 
                id: 3, 
                titulo: "Staphylococcus Aureus", 
                desc: "Tipo coco, se agrupa formando racimos irregulares, muy parecidos a un racimo de uvas. Libera la enzima coagulasa creando una pared de sangre coagulada a su alrededor. Se esconde dentro de este co√°gulo para que tus c√©lulas de defensa no puedan verla ni tocarla mientras ella se multiplica tranquilamente dentro", 
                img: "Assets/Bactcard7.jpg", 
                logro: "Maestro del Laboratorio", 
                pista: "Completa las 12 Cajas Petri simult√°neamente.",
                condicion: "FULL_HOUSE"
            },
            { 
                id: 4, 
                titulo: "Bacillus Anthracis", 
                desc: "Tipo bacilo, es rectangular y de extremos planos. Mejor conocida por ser la causante de la enfermedad conocida como √Åntrax. Cuando el ambiente se pone hostil, deja de reproducirse y fabrica una endospora en su interior es como una semilla super resistente. Puede sobrevivir d√©cadas (o siglos) en la tierra, aguantar agua hirviendo, radiaci√≥n y desinfectantes qu√≠micos. Justo una semana despu√©s de los atentados del 11 de septiembre se enviaron cartas a oficinas de medios de comunicaci√≥n y a dos senadores de EE.UU con endoesporas. Murieron 5 personas y se modific√≥ el sistema de correos a nivel mundial. Esta bacteria es la madre de la bacteriolog√≠a moderna. En 1876, Robert Koch us√≥ al Bacillus anthracis para demostrar por primera vez en la historia que un microbio espec√≠fico causa una enfermedad espec√≠fica", 
                img: "Assets/Bactcard5.jpg", 
                logro: "Descubrimiento Raro", 
                pista: "Encuentra la bacteria oculta entre las muestras",
                condicion: "DESCUBRIR_SIFILIS"
            }
        ];

        // --- 2. L√ìGICA DE DESBLOQUEO ---
        const grid = document.getElementById('grid-galeria');
        // Leemos el guardado
        const saveFile = JSON.parse(localStorage.getItem('BacterialFarm_Save1')) || { cajas: {} };
        
        function verificarDesbloqueo(tipoCondicion) {
            // Contar cu√°ntas cajas tienen { completada: true }
            let totalCompletadas = 0;
            if (saveFile.cajas) {
                totalCompletadas = Object.keys(saveFile.cajas).filter(k => saveFile.cajas[k].completada).length;
            }

            switch(tipoCondicion) {
                case "GRATIS":
                    return true; // Siempre visible
                
                case "PRIMER_CULTIVO":
                    return totalCompletadas >= 1; // Al menos 1 caja hecha

                case "FULL_HOUSE":
                    return totalCompletadas >= 12; // Las 12 cajas hechas

                case "DESCUBRIR_SIFILIS":
                    // La muestra 5 contiene la receta de Treponema.
                    // Verificamos si la caja ID 5 ha sido cultivada.
                    return saveFile.cajas && saveFile.cajas[5] && saveFile.cajas[5].completada;

                default:
                    return false;
            }
        }

        // --- 3. RENDERIZADO DEL GRID ---
        COLECCION.forEach(item => {
            const unlocked = verificarDesbloqueo(item.condicion);
            const card = document.createElement('div');
            
            // Imagen base
            let contenido = `<img src="${item.img}" class="thumb-img" alt="${item.titulo}">`;

            if (unlocked) {
                card.className = "item-galeria";
                card.onclick = () => abrirModal(item);
                // A√±adimos etiqueta del logro que aparece al hacer hover
                contenido += `<div class="badge-logro">üèÜ ${item.logro}</div>`;
            } else {
                card.className = "item-galeria item-bloqueado";
                // Capa oscura con el candado y la pista
                contenido += `
                    <div class="capa-info-bloqueo">
                        <span class="icono-candado">üîí</span>
                        <div class="texto-pista">${item.pista}</div>
                    </div>
                `;
            }

            card.innerHTML = contenido;
            grid.appendChild(card);
        });

        // --- 4. FUNCIONES MODAL ---
        const modal = document.getElementById('miModal');
        const imgGrande = document.getElementById('img-grande');
        const titGrande = document.getElementById('titulo-grande');
        const descGrande = document.getElementById('desc-grande');
        const logroFooter = document.getElementById('logro-footer');

        function abrirModal(item) {
            imgGrande.src = item.img;
            titGrande.innerText = item.titulo; // Nombre cient√≠fico
            descGrande.innerText = item.desc;  // Descripci√≥n cient√≠fica
            logroFooter.innerText = `üèÜ Logro obtenido: ${item.logro}`; // Raz√≥n del desbloqueo
            
            modal.classList.add('modal-activa');
        }

        function cerrarModal() {
            modal.classList.remove('modal-activa');
        }
    </script>

    <script src="audio-manager.js"></script>
<script>iniciarMusicaPagina(2);</script>

</body>
</html>