<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cargar Partida</title>
    <link rel="stylesheet" href="Hoja de estilo corrector.css">
</head>
<body>

    <div id="pantalla-cargar" class="overlay-carga">
        <h2 class="titulo-pixel">CARGAR PARTIDA</h2>
        
        <div class="contenedor-slots">
            <div class="slot-partida">
                <button class="btn-cargar" onclick="intentarCargar()">
                    <span class="icono-slot">üíæ</span>
                    <div class="info-partida">
                        <span id="slot-nombre" class="nombre-partida">Buscando...</span>
                        <span id="slot-fecha" class="fecha-partida">---</span>
                    </div>
                </button>

                <button id="btn-borrar" class="btn-borrar" onclick="borrarPartida()" title="Borrar Partida">
                    üóëÔ∏è
                </button>
            </div>

            <button class="btn-regresar" onclick="volverAlMenu()">
                Volver al Men√∫
            </button>
        </div>
    </div>

    <script>
        const CLAVE_GUARDADO = 'BacterialFarm_Save1';
        let urlDestino = null;

        function verificarSlot() {
            // Leemos la memoria del navegador
            const memoria = localStorage.getItem(CLAVE_GUARDADO);
            
            const textoNombre = document.getElementById('slot-nombre');
            const textoFecha = document.getElementById('slot-fecha');
            const btnBorrar = document.getElementById('btn-borrar');
            const btnCargar = document.querySelector('.btn-cargar');

            if (memoria) {
                // S√ç HAY DATOS
                const datos = JSON.parse(memoria);
                console.log("Datos encontrados:", datos); // Muestra en consola qu√© encontr√≥
                
                textoNombre.innerText = datos.nivel;
                textoFecha.innerText = datos.fecha;
                urlDestino = datos.url;
                
                btnBorrar.style.opacity = "1";
                btnBorrar.style.pointerEvents = "auto";
                btnCargar.style.opacity = "1";
            } else {
                // NO HAY DATOS
                console.log("No se encontr√≥ partida guardada.");
                textoNombre.innerText = "ESPACIO VAC√çO";
                textoFecha.innerText = "- Sin datos -";
                urlDestino = null;

                btnBorrar.style.opacity = "0.3";
                btnBorrar.style.pointerEvents = "none";
            }
        }

        function intentarCargar() {
            if (urlDestino) {
                // Si existe la URL, vamos all√°
                window.location.href = urlDestino;
            } else {
                alert("No hay partida guardada. Ve al Microscopio y dale al bot√≥n 'Guardar' primero.");
            }
        }

        function borrarPartida() {
            if(confirm("¬øBorrar partida?")) {
                localStorage.removeItem(CLAVE_GUARDADO);
                verificarSlot();
            }
        }

        function volverAlMenu() {
            window.location.href = 'index.html'; 
        }

        window.onload = verificarSlot;
    </script>

    <script src="audio-manager.js"></script>
<script>iniciarMusicaPagina(0);</script>


</body>
</html>